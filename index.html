<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saj√°t K√∂lts√©gvet√©sem 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-slate-50 p-4 md:p-8">

    <div class="max-w-5xl mx-auto">
        <header class="mb-8 text-center">
            <h1 class="text-3xl font-extrabold text-slate-800">K√∂lts√©gvet√©s 2026</h1>
            <p class="text-slate-500 font-medium">GitHub Pages alap√∫ kiad√°sk√∂vet≈ë</p>
        </header>

        <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 mb-8">
            <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                <div class="md:col-span-1">
                    <label class="block text-xs font-bold text-slate-400 mb-1 uppercase">Kateg√≥ria</label>
                    <select id="category" class="w-full p-2.5 border rounded-xl bg-slate-50 outline-none focus:ring-2 focus:ring-indigo-400 text-sm font-medium">
                        <option value="√ÅLLAND√ì K√ñLTS√âGEK">√Ålland√≥ k√∂lts√©gek</option>
                        <option value="K√ñZLEKED√âS">K√∂zleked√©s</option>
                        <option value="BEV√ÅS√ÅRL√ÅS">Bev√°s√°rl√°s</option>
                        <option value="T√ÅNC√ìR√ÅK">T√°nc√≥r√°k</option>
                        <option value="EVENT K√ñLTS√âGEK">Event k√∂lts√©gek</option>
                        <option value="MEGTAKAR√çT√ÅSOK, P√âNZ√úGYEK">Megtakar√≠t√°sok</option>
                        <option value="EGY√âB">Egy√©b</option>
                    </select>
                </div>
                <div class="md:col-span-1">
                    <label class="block text-xs font-bold text-slate-400 mb-1 uppercase">Megnevez√©s</label>
                    <input type="text" id="desc" placeholder="pl. Rezsi, B√©rlet..." class="w-full p-2.5 border rounded-xl bg-slate-50 outline-none focus:ring-2 focus:ring-indigo-400 text-sm">
                </div>
                <div>
                    <label class="block text-xs font-bold text-slate-400 mb-1 uppercase">Terv (Ft)</label>
                    <input type="number" id="planned" class="w-full p-2.5 border rounded-xl bg-slate-50 outline-none focus:ring-2 focus:ring-indigo-400 text-sm">
                </div>
                <div>
                    <label class="block text-xs font-bold text-slate-400 mb-1 uppercase">T√©ny (Ft)</label>
                    <input type="number" id="actual" class="w-full p-2.5 border rounded-xl bg-slate-50 outline-none focus:ring-2 focus:ring-indigo-400 text-sm">
                </div>
                <div class="flex items-end">
                    <button onclick="addItem()" class="w-full bg-indigo-600 text-white font-bold py-2.5 rounded-xl hover:bg-indigo-700 transition shadow-lg shadow-indigo-100 uppercase text-xs tracking-wider">
                        Hozz√°ad√°s
                    </button>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
            <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
                <h3 class="text-xs font-bold text-slate-400 uppercase mb-4 tracking-widest">Terv vs Val√≥s√°g (T√©telek)</h3>
                <div class="h-64">
                    <canvas id="barChart"></canvas>
                </div>
            </div>
            <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 flex flex-col items-center">
                <h3 class="text-xs font-bold text-slate-400 uppercase mb-4 w-full tracking-widest text-center">K√∂lt√©s megoszl√°sa</h3>
                <div class="h-64 w-full">
                    <canvas id="doughnutChart"></canvas>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
            <div class="overflow-x-auto">
                <table class="w-full text-left">
                    <thead class="bg-slate-50 border-b border-slate-100 text-slate-400 uppercase text-[10px] font-black">
                        <tr>
                            <th class="p-4">Kateg√≥ria</th>
                            <th class="p-4">T√©tel</th>
                            <th class="p-4 text-right">Tervezett</th>
                            <th class="p-4 text-right">T√©nyleges</th>
                            <th class="p-4 text-right">Elt√©r√©s</th>
                            <th class="p-4 text-center">T√∂rl√©s</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody" class="divide-y divide-slate-50 text-sm">
                        </tbody>
                </table>
            </div>
        </div>
        
        <div class="mt-6 flex justify-between items-center px-2">
            <button onclick="exportToCSV()" class="text-indigo-600 text-xs font-bold hover:underline">üì• Adatok ment√©se CSV-be</button>
            <button onclick="clearData()" class="text-red-400 hover:text-red-600 text-xs font-bold transition">üóë Minden adat t√∂rl√©se</button>
        </div>
    </div>

    <script>
        let expenses = JSON.parse(localStorage.getItem('my_budget_2026')) || [];
        let barChart, doughnutChart;

        function updateUI() {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            
            expenses.forEach((item, index) => {
                const diff = item.planned - item.actual;
                const row = `
                    <tr class="hover:bg-slate-50 transition-colors">
                        <td class="p-4"><span class="px-2 py-1 rounded-md bg-indigo-50 text-[10px] font-bold text-indigo-600 uppercase tracking-tight">${item.category}</span></td>
                        <td class="p-4 font-semibold text-slate-700">${item.desc}</td>
                        <td class="p-4 text-right text-slate-500">${Number(item.planned).toLocaleString()} Ft</td>
                        <td class="p-4 text-right font-medium text-slate-700">${Number(item.actual).toLocaleString()} Ft</td>
                        <td class="p-4 text-right font-bold ${diff < 0 ? 'text-rose-500' : 'text-emerald-500'}">${diff.toLocaleString()} Ft</td>
                        <td class="p-4 text-center">
                            <button onclick="removeItem(${index})" class="text-slate-300 hover:text-rose-500 transition-colors">‚úï</button>
                        </td>
                    </tr>`;
                tableBody.innerHTML += row;
            });

            localStorage.setItem('my_budget_2026', JSON.stringify(expenses));
            renderCharts();
        }

        function addItem() {
            const desc = document.getElementById('desc').value;
            const category = document.getElementById('category').value;
            const planned = document.getElementById('planned').value;
            const actual = document.getElementById('actual').value;

            if(desc && planned && actual) {
                expenses.push({ desc, category, planned: Number(planned), actual: Number(actual) });
                document.getElementById('desc').value = '';
                document.getElementById('planned').value = '';
                document.getElementById('actual').value = '';
                updateUI();
            }
        }

        function removeItem(index) {
            expenses.splice(index, 1);
            updateUI();
        }

        function clearData() {
            if(confirm('Biztosan t√∂r√∂lni szeretn√©l minden elmentett adatot?')) {
                expenses = [];
                updateUI();
            }
        }

        function exportToCSV() {
            let csvContent = "data:text/csv;charset=utf-8,Kategoria,Tetel,Tervezett,Teny,Elteres\n";
            expenses.forEach(e => {
                csvContent += `${e.category},${e.desc},${e.planned},${e.actual},${e.planned - e.actual}\n`;
            });
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "koltsegvetes_export.csv");
            document.body.appendChild(link);
            link.click();
        }

        function renderCharts() {
            const ctxBar = document.getElementById('barChart').getContext('2d');
            if (barChart) barChart.destroy();
            barChart = new Chart(ctxBar, {
                type: 'bar',
                data: {
                    labels: expenses.map(e => e.desc),
                    datasets: [
                        { label: 'Terv', data: expenses.map(e => e.planned), backgroundColor: '#818cf8', borderRadius: 4 },
                        { label: 'T√©ny', data: expenses.map(e => e.actual), backgroundColor: '#10b981', borderRadius: 4 }
                    ]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
            });

            const catTotals = {};
            expenses.forEach(e => { catTotals[e.category] = (catTotals[e.category] || 0) + e.actual; });

            const ctxDoughnut = document.getElementById('doughnutChart').getContext('2d');
            if (doughnutChart) doughnutChart.destroy();
            doughnutChart = new Chart(ctxDoughnut, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(catTotals),
                    datasets: [{
                        data: Object.values(catTotals),
                        backgroundColor: ['#f87171', '#fbbf24', '#34d399', '#60a5fa', '#818cf8', '#a78bfa', '#cbd5e1']
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { boxWidth: 10, font: { size: 10 } } } } }
            });
        }

        window.onload = updateUI;
    </script>
</body>
</html>
